!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("difflib"),require("vkbeautify"),require("x2js")):"function"==typeof define&&define.amd?define("jasmine-snapshot",["difflib","vkbeautify","x2js"],n):"object"==typeof exports?exports["jasmine-snapshot"]=n(require("difflib"),require("vkbeautify"),require("x2js")):t["jasmine-snapshot"]=n(t.difflib,t.vkbeautify,t.x2js)}(this,function(t,n,e){return function(t){function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var e={};return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=4)}([function(t,n){var e=window.console.warn;window.console.warn=function(){arguments.length>0&&"string"==typeof arguments[0]&&-1!==arguments[0].indexOf("[xmldom ")||e.apply(window.console,arguments)};var o=window.console.error;window.console.error=function(){arguments.length>0&&"string"==typeof arguments[0]&&-1!==arguments[0].indexOf("entity not found")||o.apply(window.console,arguments)}},function(n,e){n.exports=t},function(t,e){t.exports=n},function(t,n){t.exports=e},function(t,n,e){"use strict";function o(t,n){v=t,g=new w(_,n)}function r(){n.KeyExceptionList=["typeof"]}function i(t,n,e){if(n!==t){var o=h.default.unifiedDiff(t.split("\n"),n.split("\n"));if(e){if(!g)throw"autoagic snapshot with no registered snapshot object";g.reportFailure(o)}var r="\n";if(r+="**** "+m+" diff *****\n\n",o.forEach(function(t){"--- \n"===t||"+++ \n"===t||t.length>5&&"@@"===t.slice(0,2)||(r+=t+"\n")}),r+="\n",!e){var i=s(n);r+="**** If the Actual is valid, update the snapshot with this ****\n",r+=" ----- Formatted ------\n"+n+"\n\n ----- Single Line ------\n"+i}console.error(r),fail("Actual does not match snapshot. See above. ")}}function s(t){for(var n=t.replace(/\n/g,"").replace(/\t/g,"").replace(/\\"/g,'\\\\\\"');-1!==n.indexOf("  ");)n=n.replace(/(  )/g," ");return n}function a(t,n){f(n).toMatchSnapshot(t)}function u(t,n){var e=n?d.json(n):n;i(t?d.json(t):t,e)}function c(t,n){p(n).toMatchSnapshot(t)}function p(t){return new S(t)}function f(t){return new A(t)}var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var h=e(1),d=e(2),y=e(3);e(0);var v={};n.registerSnapshots=o;var g,b=function(){function t(){}return t}(),x=new Array,w=function(){function t(t,n){this.snapshots=Array(),this.level=0,this.fail_counter_for_autosnapshot=0,this.last_automagic_snapshot=0,this.level=t,this.name=n}return t.prototype.getSnapshotAutomagically_saveActual=function(t){var n=new b;n.key=s(m+" "+ ++this.last_automagic_snapshot),n.text=s(t),this.snapshots.push(n);var e=v[n.key];return e||""},t.prototype.hasFailure=function(){return this.fail_counter_for_autosnapshot>0},t.prototype.reportFailure=function(t){this.snapshots[this.snapshots.length-1].diff=t,this.fail_counter_for_autosnapshot++},t.prototype.getText=function(){for(var t="\n**** If actual is valid, update your snapshot with the following ****\n{",n=!1,e=0,o=this.snapshots;e<o.length;e++){var r=o[e];n=!0,t+='\n\t"'+r.key+'": `'+r.text+"`,"}return n&&(t=t.slice(0,t.length-1),t+="\n}\n\n"),t},t.prototype.pushToHistory=function(){x.push(this)},t.prototype.getHTML=function(){if(!this.name)throw"name not defined for snapshot suite";if(!this.hasFailure())return'<p style="color: green; font-size: 25px; font-weight: bold;">===Auto snapshot suite, '+this.name+", has no problems!===</p>";var t='<p style="color: red; font-size: 25px; font-weight: bold;">===Suite, '+this.name+", had problems===</p>";this.snapshots.forEach(function(n){n.diff&&(t+='<div>>Test: "'+n.key+'" did not match the snapshot:</div><br //>',n.diff.forEach(function(n){n.length>=3&&("---"===n.slice(0,3)||"+++"===n.slice(0,3))||"@@"===n.slice(0,2)||("-"===n.charAt(0)?t+='<span style="color: red">'+n.replace(/ /g,"&nbsp;")+"</span><br //>":"+"===n.charAt(0)?t+='<span style="color: green">'+n.replace(/ /g,"&nbsp;")+"</span><br //>":t+=n.replace(/ /g,"&nbsp;")+"<br //>")}))}),t+='<p style="text-decoration: underline; font-weight: bold;">If actual is valid, update your snapshot with the following <//p>',t+="<div style='color: blue;'>{";for(var n=!1,e=0,o=this.snapshots;e<o.length;e++){var r=o[e];n=!0,t+='<br //>&nbsp;&nbsp;&nbsp;&nbsp;"'+r.key+'": `'+r.text+"`,"}return n&&(t=t.slice(0,t.length-1),t+="<br //>}</div></p>"),t},t}(),m="",_=0;jasmine.getEnv().addReporter({suiteStarted:function(t){_++},specStarted:function(t){m=t.fullName},suiteDone:function(t){_--,g&&_<g.level&&(g.hasFailure&&console.error(g.getText()),g.pushToHistory(),g=null)},jasmineDone:function(t){if(g&&(g.hasFailure&&console.error(g.getText()),g.pushToHistory(),g=null),0!==x.length){var n=x.reduce(function(t,n){return t+"<br //>"+n.getHTML()},"");document.body.innerHTML=n}}}),n.KeyExceptionList=["typeof"],n.ResetExceptionList=r,n.MatchesSnapshot=i,n.MatchesXMLSnapshot=a,n.MatchesJSONSnapshot=u,n.MatchesJSSnapshot=c,n.expectjs=p,n.expectxml=f;var j=function(){function t(t){this.actual=t}return t.prototype.afterApplying=function(t){return this.actual=t(this.actual),this},t}(),S=function(t){function e(n){var e=t.call(this,n)||this;return e.parsed_values=new Array,e.actual=n,e}return l(e,t),e.prototype.toMatchSnapshot=function(t){var n=this.actual?d.json(this.getOrderedStringifyAndClean()):"",e=t,o=!1;if(null===t||void 0===t){if(!g)throw"Use of autosnapshot without registering snapshot object";o=!0;var r=g.getSnapshotAutomagically_saveActual(n);e=r?d.json(r):""}else e=t?d.json(t):t;i(e,n,o)},e.prototype.getOrderedStringifyAndClean=function(){var t=this.collectAllKeysAndRemoveCircular(this.actual);return JSON.stringify(this.actual,t)},e.prototype.collectAllKeysAndRemoveCircular=function(t){var n=this,e=new Array,o=JSON.stringify(t,function(t,o){if(!n.isIEPooOrCurcularReferences(t,o))return e.push(t),o});return this.actual=JSON.parse(o),e.sort(function(t,n){return t>n?1:-1})},e.prototype.isIEPooOrCurcularReferences=function(t,e){return!("string"!=typeof t||!n.KeyExceptionList.some(function(n){return-1!==t.indexOf(n)}))||!!this.IsCurcularDependency(e)},e.prototype.IsCurcularDependency=function(t){return!(!t||"object"!=typeof t)&&(-1!==this.parsed_values.indexOf(t)||(this.parsed_values.push(t),!1))},e}(j);n.SnapshotJSInner=S;var A=function(t){function n(n){var e=t.call(this,n)||this;return e.actual=n,e}return l(n,t),n.prototype.toMatchSnapshot=function(t){p((new y).xml2js(this.actual)).toMatchSnapshot(t)},n}(j);n.SnapshotXMLInner=A}])});