!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("difflib"),require("vkbeautify"),require("x2js")):"function"==typeof define&&define.amd?define("jasmine-snapshot",["difflib","vkbeautify","x2js"],e):"object"==typeof exports?exports["jasmine-snapshot"]=e(require("difflib"),require("vkbeautify"),require("x2js")):t["jasmine-snapshot"]=e(t.difflib,t.vkbeautify,t.x2js)}(this,function(t,e,n){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e){var n=window.console.warn;window.console.warn=function(){arguments.length>0&&"string"==typeof arguments[0]&&-1!==arguments[0].indexOf("[xmldom ")||n.apply(window.console,arguments)};var o=window.console.error;window.console.error=function(){arguments.length>0&&"string"==typeof arguments[0]&&-1!==arguments[0].indexOf("entity not found")||o.apply(window.console,arguments)}},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e,n){"use strict";function o(t,e){v=t,g=new x(_,e)}function r(){e.KeyExceptionList=["typeof"]}function i(t,e,n){if(e!==t){var o=h.default.unifiedDiff(t.split("\n"),e.split("\n"));if(n){if(!g)throw"autoagic snapshot with no registered snapshot object";g.reportFailure(o)}var r="\n";if(r+="**** "+m+" diff *****\n\n",o.forEach(function(t){"--- \n"===t||"+++ \n"===t||t.length>5&&"@@"===t.slice(0,2)||(r+=t+"\n")}),r+="\n",!n){var i=s(e);r+="**** If the Actual is valid, update the snapshot with this ****\n",r+=" ----- Formatted ------\n"+e+"\n\n ----- Single Line ------\n"+i}console.error(r),fail("Actual does not match snapshot. See above. ")}}function s(t){for(var e=t.replace(/\n/g,"").replace(/\t/g,"").replace(/\\"/g,'\\\\\\"');-1!==e.indexOf("  ");)e=e.replace(/(  )/g," ");return e}function a(t,e){f(e).toMatchSnapshot(t)}function u(t,e){var n=e?d.json(e):e;i(t?d.json(t):t,n)}function c(t,e){p(e).toMatchSnapshot(t)}function p(t){return new j(t)}function f(t){return new A(t)}var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var h=n(1),d=n(2),y=n(3);n(0);var v={};e.registerSnapshots=o;var g,b=function(){function t(){}return t}(),w=new Array,x=function(){function t(t,e){this.snapshots=Array(),this.level=0,this.fail_counter_for_autosnapshot=0,this.last_automagic_snapshot=0,this.level=t,this.name=e}return t.prototype.getSnapshotAutomagically_saveActual=function(t){var e=new b;e.key=s(m+" "+ ++this.last_automagic_snapshot),e.text=s(t),this.snapshots.push(e);var n=v[e.key];return n||""},t.prototype.hasFailure=function(){return this.fail_counter_for_autosnapshot>0},t.prototype.reportFailure=function(t){this.snapshots[this.snapshots.length-1].diff=t,this.fail_counter_for_autosnapshot++},t.prototype.getText=function(){for(var t="\n**** If actual is valid, update your snapshot with the following ****\n{",e=!1,n=0,o=this.snapshots;n<o.length;n++){var r=o[n];e=!0,t+='\n\t"'+r.key+'": `'+r.text+"`,"}return e&&(t=t.slice(0,t.length-1),t+="\n}\n\n"),t},t.prototype.pushToHistory=function(){w.push(this)},t.prototype.getHTML=function(){if(document.body.style.fontFamily="Courier New",document.body.style.whiteSpace="nowrap",!this.name)throw"name not defined for snapshot suite";if(!this.hasFailure())return'<p style="color: green; font-size: 25px; font-weight: bold;">===Auto snapshot suite, '+this.name+", has no problems!===</p>";var t='<p style="color: red; font-size: 25px; font-weight: bold;">===Suite, '+this.name+", had problems===</p>";this.snapshots.forEach(function(e){e.diff&&(t+='<div>>Test: "'+e.key+'" did not match the snapshot:</div><br //>',e.diff.forEach(function(e){e.length>=3&&("---"===e.slice(0,3)||"+++"===e.slice(0,3))||"@@"===e.slice(0,2)||("-"===e.charAt(0)?t+='<span style="color: red">'+e.replace(/ /g,"&nbsp;")+"</span><br //>":"+"===e.charAt(0)?t+='<span style="color: green">'+e.replace(/ /g,"&nbsp;")+"</span><br //>":t+=e.replace(/ /g,"&nbsp;")+"<br //>")}))}),t+='<p style="text-decoration: underline; font-weight: bold;">If actual is valid, update your snapshot with the following <//p>',t+="<div style='color: blue;'>{";for(var e=!1,n=0,o=this.snapshots;n<o.length;n++){var r=o[n];e=!0,t+='<br //>&nbsp;&nbsp;&nbsp;&nbsp;"'+r.key+'": `'+r.text+"`,"}return e&&(t=t.slice(0,t.length-1),t+="<br //>}</div></p>"),t},t}(),m="",_=0;jasmine.getEnv().addReporter({suiteStarted:function(t){_++},specStarted:function(t){m=t.fullName},suiteDone:function(t){_--,g&&_<g.level&&(g.hasFailure&&console.error(g.getText()),g.pushToHistory(),g=null)},jasmineDone:function(t){if(g&&(g.hasFailure&&console.error(g.getText()),g.pushToHistory(),g=null),0!==w.length){var e=w.reduce(function(t,e){return t+"<br //>"+e.getHTML()},"");document.body.innerHTML=e}}}),e.KeyExceptionList=["typeof"],e.ResetExceptionList=r,e.MatchesSnapshot=i,e.MatchesXMLSnapshot=a,e.MatchesJSONSnapshot=u,e.MatchesJSSnapshot=c,e.expectjs=p,e.expectxml=f;var S=function(){function t(t){this.actual=t}return t.prototype.afterApplying=function(t){return this.actual=t(this.actual),this},t}(),j=function(t){function n(e){var n=t.call(this,e)||this;return n.parsed_values=new Array,n.actual=e,n}return l(n,t),n.prototype.toMatchSnapshot=function(t){var e=this.actual?d.json(this.getOrderedStringifyAndClean()):"",n=t,o=!1;if(null===t||void 0===t){if(!g)throw"Use of autosnapshot without registering snapshot object";o=!0;var r=g.getSnapshotAutomagically_saveActual(e);n=r?d.json(r):""}else n=t?d.json(t):t;i(n,e,o)},n.prototype.getOrderedStringifyAndClean=function(){var t=this.collectAllKeysAndRemoveCircular(this.actual);return JSON.stringify(this.actual,t)},n.prototype.collectAllKeysAndRemoveCircular=function(t){var e=this,n=new Array,o=JSON.stringify(t,function(t,o){if(!e.isIEPooOrCurcularReferences(t,o))return n.push(t),o});return this.actual=JSON.parse(o),n.sort(function(t,e){return t>e?1:-1})},n.prototype.isIEPooOrCurcularReferences=function(t,n){return!("string"!=typeof t||!e.KeyExceptionList.some(function(e){return-1!==t.indexOf(e)}))||!!this.IsCurcularDependency(n)},n.prototype.IsCurcularDependency=function(t){return!(!t||"object"!=typeof t)&&(-1!==this.parsed_values.indexOf(t)||(this.parsed_values.push(t),!1))},n}(S);e.SnapshotJSInner=j;var A=function(t){function e(e){var n=t.call(this,e)||this;return n.actual=e,n}return l(e,t),e.prototype.toMatchSnapshot=function(t){p((new y).xml2js(this.actual)).toMatchSnapshot(t)},e}(S);e.SnapshotXMLInner=A}])});